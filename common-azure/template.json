{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "serviceIdentifier": {
      "type": "string",
      "minLength": 4,
      "maxLength": 4
    },
    "environment": {
      "type": "string",
      "defaultValue": "d",
      "allowedValues": [
        "d",
        "t",
        "p"
      ]
    },
    "environmentName": {
      "type": "string",
      "defaultValue": "DEV",
      "allowedValues": [
        "DEV",
        "TEST",
        "OAT",
        "PROD"
      ]
    },
    "environmentInstance": {
      "type": "string",
      "minLength": 2,
      "maxLength": 2,
      "defaultValue": "01"
    },
    "appInsightsInstance": {
      "type": "string",
      "minLength": 2,
      "maxLength": 2,
      "defaultValue": "01"
    },
    "giasHeartbeatUrl": {
      "type": "string"
    },
    "ukrlpHeartbeatUrl": {
      "type": "string"
    },
    "eventBrokerHeartbeatUrl": {
      "type": "string"
    },
    "registryHeartbeatUrl": {
      "type": "string"
    },
    "squasherHeartbeatUrl": {
      "type": "string"
    },
    "translationHeartbeatUrl": {
      "type": "string"
    },
    "graphHeartbeatUrl": {
      "type": "string"
    }
  },
  "variables": {
    "namePrefix": "[concat(parameters('serviceIdentifier'), parameters('environment'), parameters('environmentInstance'))]",
    "appInsightsName": "[concat(variables('namePrefix'), '-ai-', parameters('appInsightsInstance'))]",
    "appInsightsId": "[concat(resourceGroup().id, '/providers/microsoft.insights/components/', variables('appInsightsName'))]",
    "webTestSuffix": "wt-01",
    "giasWebTestName": "[concat(variables('namePrefix'), '-giasadpt-', variables('webTestSuffix'))]",
    "giasWebTestId": "283902b6-3551-43c0-85fb-417cc4dafbf1",

    "ukrlpWebTestName": "[concat(variables('namePrefix'), '-giasadpt-', variables('webTestSuffix'))]",
    "ukrlpWebTestId": "283902b6-3551-43c0-85fb-417cc4dafbf1",

    "eventBrokerWebTestName": "[concat(variables('namePrefix'), '-giasadpt-', variables('webTestSuffix'))]",
    "eventBrokerWebTestId": "283902b6-3551-43c0-85fb-417cc4dafbf1",

    "registryWebTestName": "[concat(variables('namePrefix'), '-giasadpt-', variables('webTestSuffix'))]",
    "registryWebTestId": "283902b6-3551-43c0-85fb-417cc4dafbf1",

    "squasherWebTestName": "[concat(variables('namePrefix'), '-giasadpt-', variables('webTestSuffix'))]",
    "sqausherWebTestId": "283902b6-3551-43c0-85fb-417cc4dafbf1",

    "translationWebTestName": "[concat(variables('namePrefix'), '-giasadpt-', variables('webTestSuffix'))]",
    "translationWebTestId": "283902b6-3551-43c0-85fb-417cc4dafbf1",

    "graphWebTestName": "[concat(variables('namePrefix'), '-giasadpt-', variables('webTestSuffix'))]",
    "graphWebTestId": "283902b6-3551-43c0-85fb-417cc4dafbf1"
  },
  "resources": [
    {
      "apiVersion": "2015-05-01",
      "name": "[variables('appInsightsName')]",
      "type": "Microsoft.Insights/components",
      "location": "[resourceGroup().location]",
      "kind": "web",
      "tags": {
        "environment": "[parameters('environmentName')]"
      },
      "properties": {
        "Application_Type": "web"
      }
    },
    {
      "type": "microsoft.insights/webtests",
      "apiVersion": "2015-05-01",
      "name": "[variables('giasWebTestName')]",
      "location": "westeurope",
      "tags": {
        "[concat('hidden-link:', variables('appInsightsId'))]": "Resource"
      },
      "dependsOn": [
        "[variables('appInsightsId')]"
      ],
      "properties": {
        "SyntheticMonitorId": "[variables('giasWebTestName')]",
        "Name": "[variables('giasWebTestName')]",
        "Enabled": true,
        "Frequency": 300,
        "Timeout": 30,
        "Kind": "ping",
        "RetryEnabled": true,
        "Locations": [
          {
            "Id": "emea-nl-ams-azr"
          },
          {
            "Id": "emea-ru-msa-edge"
          },
          {
            "Id": "emea-se-sto-edge"
          },
          {
            "Id": "emea-gb-db3-azr"
          }
        ],
        "Configuration": {
          "WebTest": "[concat('<WebTest Name=\"', variables('giasWebTestName'), '\" Id=\"', variables('giasWebTestId'), '\" Enabled=\"True\" CssProjectStructure=\"\" CssIteration=\"\" Timeout=\"30\" WorkItemIds=\"\" xmlns=\"http://microsoft.com/schemas/VisualStudio/TeamTest/2010\" Description=\"\" CredentialUserName=\"\" CredentialPassword=\"\" PreAuthenticate=\"True\" Proxy=\"default\" StopOnError=\"False\" RecordedResultFile=\"\" ResultsLocale=\"\"><Items><Request Method=\"GET\" Guid=\"a44ea745-25df-965b-3329-dd3058d8b70e\" Version=\"1.1\" Url=\"', parameters('giasHeartbeatUrl'),'\" ThinkTime=\"0\" Timeout=\"30\" ParseDependentRequests=\"False\" FollowRedirects=\"True\" RecordResult=\"True\" Cache=\"False\" ResponseTimeGoal=\"0\" Encoding=\"utf-8\" ExpectedHttpStatusCode=\"200\" ExpectedResponseUrl=\"\" ReportingName=\"\" IgnoreHttpStatusCode=\"False\" /></Items></WebTest>')]"
        }
      }
    },

    {
      "type": "microsoft.insights/webtests",
      "apiVersion": "2015-05-01",
      "name": "[variables('ukrlpWebTestName')]",
      "location": "westeurope",
      "tags": {
        "[concat('hidden-link:', variables('appInsightsId'))]": "Resource"
      },
      "dependsOn": [
        "[variables('appInsightsId')]"
      ],
      "properties": {
        "SyntheticMonitorId": "[variables('ukrlpWebTestName')]",
        "Name": "[variables('ukrlpWebTestName')]",
        "Enabled": true,
        "Frequency": 300,
        "Timeout": 30,
        "Kind": "ping",
        "RetryEnabled": true,
        "Locations": [
          {
            "Id": "emea-nl-ams-azr"
          },
          {
            "Id": "emea-ru-msa-edge"
          },
          {
            "Id": "emea-se-sto-edge"
          },
          {
            "Id": "emea-gb-db3-azr"
          }
        ],
        "Configuration": {
          "WebTest": "[concat('<WebTest Name=\"', variables('ukrlpWebTestName'), '\" Id=\"', variables('ukrlpWebTestId'), '\" Enabled=\"True\" CssProjectStructure=\"\" CssIteration=\"\" Timeout=\"30\" WorkItemIds=\"\" xmlns=\"http://microsoft.com/schemas/VisualStudio/TeamTest/2010\" Description=\"\" CredentialUserName=\"\" CredentialPassword=\"\" PreAuthenticate=\"True\" Proxy=\"default\" StopOnError=\"False\" RecordedResultFile=\"\" ResultsLocale=\"\"><Items><Request Method=\"GET\" Guid=\"a44ea745-25df-965b-3329-dd3058d8b70e\" Version=\"1.1\" Url=\"', parameters('ukrlpHeartbeatUrl'),'\" ThinkTime=\"0\" Timeout=\"30\" ParseDependentRequests=\"False\" FollowRedirects=\"True\" RecordResult=\"True\" Cache=\"False\" ResponseTimeGoal=\"0\" Encoding=\"utf-8\" ExpectedHttpStatusCode=\"200\" ExpectedResponseUrl=\"\" ReportingName=\"\" IgnoreHttpStatusCode=\"False\" /></Items></WebTest>')]"
        }
      }
    },

    {
      "type": "microsoft.insights/webtests",
      "apiVersion": "2015-05-01",
      "name": "[variables('eventBrokerWebTestName')]",
      "location": "westeurope",
      "tags": {
        "[concat('hidden-link:', variables('appInsightsId'))]": "Resource"
      },
      "dependsOn": [
        "[variables('appInsightsId')]"
      ],
      "properties": {
        "SyntheticMonitorId": "[variables('eventBrokerWebTestName')]",
        "Name": "[variables('eventBrokerWebTestName')]",
        "Enabled": true,
        "Frequency": 300,
        "Timeout": 30,
        "Kind": "ping",
        "RetryEnabled": true,
        "Locations": [
          {
            "Id": "emea-nl-ams-azr"
          },
          {
            "Id": "emea-ru-msa-edge"
          },
          {
            "Id": "emea-se-sto-edge"
          },
          {
            "Id": "emea-gb-db3-azr"
          }
        ],
        "Configuration": {
          "WebTest": "[concat('<WebTest Name=\"', variables('eventBrokerWebTestName'), '\" Id=\"', variables('eventBrokerWebTestId'), '\" Enabled=\"True\" CssProjectStructure=\"\" CssIteration=\"\" Timeout=\"30\" WorkItemIds=\"\" xmlns=\"http://microsoft.com/schemas/VisualStudio/TeamTest/2010\" Description=\"\" CredentialUserName=\"\" CredentialPassword=\"\" PreAuthenticate=\"True\" Proxy=\"default\" StopOnError=\"False\" RecordedResultFile=\"\" ResultsLocale=\"\"><Items><Request Method=\"GET\" Guid=\"a44ea745-25df-965b-3329-dd3058d8b70e\" Version=\"1.1\" Url=\"', parameters('eventBrokerHeartbeatUrl'),'\" ThinkTime=\"0\" Timeout=\"30\" ParseDependentRequests=\"False\" FollowRedirects=\"True\" RecordResult=\"True\" Cache=\"False\" ResponseTimeGoal=\"0\" Encoding=\"utf-8\" ExpectedHttpStatusCode=\"200\" ExpectedResponseUrl=\"\" ReportingName=\"\" IgnoreHttpStatusCode=\"False\" /></Items></WebTest>')]"
        }
      }
    },

    {
      "type": "microsoft.insights/webtests",
      "apiVersion": "2015-05-01",
      "name": "[variables('registryWebTestName')]",
      "location": "westeurope",
      "tags": {
        "[concat('hidden-link:', variables('appInsightsId'))]": "Resource"
      },
      "dependsOn": [
        "[variables('appInsightsId')]"
      ],
      "properties": {
        "SyntheticMonitorId": "[variables('registryWebTestName')]",
        "Name": "[variables('registryWebTestName')]",
        "Enabled": true,
        "Frequency": 300,
        "Timeout": 30,
        "Kind": "ping",
        "RetryEnabled": true,
        "Locations": [
          {
            "Id": "emea-nl-ams-azr"
          },
          {
            "Id": "emea-ru-msa-edge"
          },
          {
            "Id": "emea-se-sto-edge"
          },
          {
            "Id": "emea-gb-db3-azr"
          }
        ],
        "Configuration": {
          "WebTest": "[concat('<WebTest Name=\"', variables('registryWebTestName'), '\" Id=\"', variables('registryWebTestId'), '\" Enabled=\"True\" CssProjectStructure=\"\" CssIteration=\"\" Timeout=\"30\" WorkItemIds=\"\" xmlns=\"http://microsoft.com/schemas/VisualStudio/TeamTest/2010\" Description=\"\" CredentialUserName=\"\" CredentialPassword=\"\" PreAuthenticate=\"True\" Proxy=\"default\" StopOnError=\"False\" RecordedResultFile=\"\" ResultsLocale=\"\"><Items><Request Method=\"GET\" Guid=\"a44ea745-25df-965b-3329-dd3058d8b70e\" Version=\"1.1\" Url=\"', parameters('registryHeartbeatUrl'),'\" ThinkTime=\"0\" Timeout=\"30\" ParseDependentRequests=\"False\" FollowRedirects=\"True\" RecordResult=\"True\" Cache=\"False\" ResponseTimeGoal=\"0\" Encoding=\"utf-8\" ExpectedHttpStatusCode=\"200\" ExpectedResponseUrl=\"\" ReportingName=\"\" IgnoreHttpStatusCode=\"False\" /></Items></WebTest>')]"
        }
      }
    },

    {
      "type": "microsoft.insights/webtests",
      "apiVersion": "2015-05-01",
      "name": "[variables('squasherWebTestName')]",
      "location": "westeurope",
      "tags": {
        "[concat('hidden-link:', variables('appInsightsId'))]": "Resource"
      },
      "dependsOn": [
        "[variables('appInsightsId')]"
      ],
      "properties": {
        "SyntheticMonitorId": "[variables('squasherWebTestName')]",
        "Name": "[variables('giasWebTestName')]",
        "Enabled": true,
        "Frequency": 300,
        "Timeout": 30,
        "Kind": "ping",
        "RetryEnabled": true,
        "Locations": [
          {
            "Id": "emea-nl-ams-azr"
          },
          {
            "Id": "emea-ru-msa-edge"
          },
          {
            "Id": "emea-se-sto-edge"
          },
          {
            "Id": "emea-gb-db3-azr"
          }
        ],
        "Configuration": {
          "WebTest": "[concat('<WebTest Name=\"', variables('squasherWebTestName'), '\" Id=\"', variables('squasherWebTestId'), '\" Enabled=\"True\" CssProjectStructure=\"\" CssIteration=\"\" Timeout=\"30\" WorkItemIds=\"\" xmlns=\"http://microsoft.com/schemas/VisualStudio/TeamTest/2010\" Description=\"\" CredentialUserName=\"\" CredentialPassword=\"\" PreAuthenticate=\"True\" Proxy=\"default\" StopOnError=\"False\" RecordedResultFile=\"\" ResultsLocale=\"\"><Items><Request Method=\"GET\" Guid=\"a44ea745-25df-965b-3329-dd3058d8b70e\" Version=\"1.1\" Url=\"', parameters('squasherHeartbeatUrl'),'\" ThinkTime=\"0\" Timeout=\"30\" ParseDependentRequests=\"False\" FollowRedirects=\"True\" RecordResult=\"True\" Cache=\"False\" ResponseTimeGoal=\"0\" Encoding=\"utf-8\" ExpectedHttpStatusCode=\"200\" ExpectedResponseUrl=\"\" ReportingName=\"\" IgnoreHttpStatusCode=\"False\" /></Items></WebTest>')]"
        }
      }
    },

    {
      "type": "microsoft.insights/webtests",
      "apiVersion": "2015-05-01",
      "name": "[variables('translationWebTestName')]",
      "location": "westeurope",
      "tags": {
        "[concat('hidden-link:', variables('appInsightsId'))]": "Resource"
      },
      "dependsOn": [
        "[variables('appInsightsId')]"
      ],
      "properties": {
        "SyntheticMonitorId": "[variables('translationWebTestName')]",
        "Name": "[variables('translationWebTestName')]",
        "Enabled": true,
        "Frequency": 300,
        "Timeout": 30,
        "Kind": "ping",
        "RetryEnabled": true,
        "Locations": [
          {
            "Id": "emea-nl-ams-azr"
          },
          {
            "Id": "emea-ru-msa-edge"
          },
          {
            "Id": "emea-se-sto-edge"
          },
          {
            "Id": "emea-gb-db3-azr"
          }
        ],
        "Configuration": {
          "WebTest": "[concat('<WebTest Name=\"', variables('translationWebTestName'), '\" Id=\"', variables('translationWebTestId'), '\" Enabled=\"True\" CssProjectStructure=\"\" CssIteration=\"\" Timeout=\"30\" WorkItemIds=\"\" xmlns=\"http://microsoft.com/schemas/VisualStudio/TeamTest/2010\" Description=\"\" CredentialUserName=\"\" CredentialPassword=\"\" PreAuthenticate=\"True\" Proxy=\"default\" StopOnError=\"False\" RecordedResultFile=\"\" ResultsLocale=\"\"><Items><Request Method=\"GET\" Guid=\"a44ea745-25df-965b-3329-dd3058d8b70e\" Version=\"1.1\" Url=\"', parameters('translationHeartbeatUrl'),'\" ThinkTime=\"0\" Timeout=\"30\" ParseDependentRequests=\"False\" FollowRedirects=\"True\" RecordResult=\"True\" Cache=\"False\" ResponseTimeGoal=\"0\" Encoding=\"utf-8\" ExpectedHttpStatusCode=\"200\" ExpectedResponseUrl=\"\" ReportingName=\"\" IgnoreHttpStatusCode=\"False\" /></Items></WebTest>')]"
        }
      }
    },

    {
      "type": "microsoft.insights/webtests",
      "apiVersion": "2015-05-01",
      "name": "[variables('graphWebTestName')]",
      "location": "westeurope",
      "tags": {
        "[concat('hidden-link:', variables('appInsightsId'))]": "Resource"
      },
      "dependsOn": [
        "[variables('appInsightsId')]"
      ],
      "properties": {
        "SyntheticMonitorId": "[variables('graphWebTestName')]",
        "Name": "[variables('graphWebTestName')]",
        "Enabled": true,
        "Frequency": 300,
        "Timeout": 30,
        "Kind": "ping",
        "RetryEnabled": true,
        "Locations": [
          {
            "Id": "emea-nl-ams-azr"
          },
          {
            "Id": "emea-ru-msa-edge"
          },
          {
            "Id": "emea-se-sto-edge"
          },
          {
            "Id": "emea-gb-db3-azr"
          }
        ],
        "Configuration": {
          "WebTest": "[concat('<WebTest Name=\"', variables('graphWebTestName'), '\" Id=\"', variables('graphWebTestId'), '\" Enabled=\"True\" CssProjectStructure=\"\" CssIteration=\"\" Timeout=\"30\" WorkItemIds=\"\" xmlns=\"http://microsoft.com/schemas/VisualStudio/TeamTest/2010\" Description=\"\" CredentialUserName=\"\" CredentialPassword=\"\" PreAuthenticate=\"True\" Proxy=\"default\" StopOnError=\"False\" RecordedResultFile=\"\" ResultsLocale=\"\"><Items><Request Method=\"GET\" Guid=\"a44ea745-25df-965b-3329-dd3058d8b70e\" Version=\"1.1\" Url=\"', parameters('graphHeartbeatUrl'),'\" ThinkTime=\"0\" Timeout=\"30\" ParseDependentRequests=\"False\" FollowRedirects=\"True\" RecordResult=\"True\" Cache=\"False\" ResponseTimeGoal=\"0\" Encoding=\"utf-8\" ExpectedHttpStatusCode=\"200\" ExpectedResponseUrl=\"\" ReportingName=\"\" IgnoreHttpStatusCode=\"False\" /></Items></WebTest>')]"
        }
      }
    }
  ]
}
